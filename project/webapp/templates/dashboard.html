{% extends 'base.html' %}


{% block title %}Accueil{% endblock title %}

{% block page-id %}dashboard-container{% endblock page-id %}

{% block content %}
<div class="container apps card-top">
    <div class="left-apps">
        <div class="card app card-dashboard" 
            onclick="redirect('{% url 'details_logs' %}')" 
            onmouseover="show_element('.not-first-logs')"
            onmouseout="hide_element('.not-first-logs')">
            <div class="card-stamp">
                <div class="card-stamp-icon bg-green">
                    <svg xmlns="http://www.w3.org/2000/svg" 
                        class="icon icon-tabler icon-tabler-brand-tabler" width="44" height="44"
                        viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" 
                        stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M8 9l3 3l-3 3" />
                        <line x1="13" y1="15" x2="16" y2="15" />
                        <rect x="4" y="4" width="16" height="16" rx="4" />
                    </svg>
                </div>
            </div>
            <h2>Logs</h2>
            <div class="card-body last-data">
                <samp style="font-size: small;">
                    <table id="table"
                        data-toggle="table">
                        <thead>
                            <tr>
                                <th class="short-cell" scope="col" data-field="source">Source</th>
                                <th class="short-cell" scope="col" data-field="date">Date</th>
                                <th class="short-cell" scope="col" data-field="status">Statut</th>
                                <th scope="col" data-field="content">Contenu</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for log in data.last_logs %}
                                <tr 
                                {% if log == data.last_logs.0 %} 
                                    class="first-element" 
                                {% else %} 
                                    class="not-first-logs"
                                {% endif %}>
                                    <td class="short-cell">{{ log.source }}</td>
                                    <td class="short-cell">{{ log.datetime }}</td>
                                    <td class="short-cell">{{ log.status }}</td>
                                    <td class="long-cell">
                                        {{ log.content|slice:"67" }} 
                                        {% if log.content|length > 67 %}...{% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </samp>
            </div>
        </div>

        <div class="card app card-dashboard" 
            onclick="redirect('{% url 'queries' %}')"
            onmouseover="show_element('.not-first-queries')"
            onmouseout="hide_element('.not-first-queries')">
            <div class="card-stamp">
                <div class="card-stamp-icon bg-red">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-border-inner" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <line x1="4" y1="12" x2="20" y2="12" />
                        <line x1="12" y1="4" x2="12" y2="20" />
                        <line x1="4" y1="4" x2="4" y2="4.01" />
                        <line x1="8" y1="4" x2="8" y2="4.01" />
                        <line x1="16" y1="4" x2="16" y2="4.01" />
                        <line x1="20" y1="4" x2="20" y2="4.01" />
                        <line x1="4" y1="8" x2="4" y2="8.01" />
                        <line x1="20" y1="8" x2="20" y2="8.01" />
                        <line x1="4" y1="16" x2="4" y2="16.01" />
                        <line x1="20" y1="16" x2="20" y2="16.01" />
                        <line x1="4" y1="20" x2="4" y2="20.01" />
                        <line x1="8" y1="20" x2="8" y2="20.01" />
                        <line x1="16" y1="20" x2="16" y2="20.01" />
                        <line x1="20" y1="20" x2="20" y2="20.01" />
                    </svg>
                </div>
            </div>
            <h2>Requêtes precisions</h2>
            <div class="card-body last-data">
                <samp style="font-size: small;">
                    <table id="table"
                        data-toggle="table">
                        <thead>
                            <tr>
                                <th class="short-cell" scope="col" data-field="datetime">Date</th>
                                <th scope="col" data-field="content">Contenu</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for query in data.last_queries %}
                                <tr
                                {% if query == data.last_queries.0 %} 
                                    class="first-element"
                                {% else %} 
                                    class="not-first-queries"
                                {% endif %}>
                                    <td class="short-cell">{{ query.datetime }}</td>
                                    <td>{{ query.content }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </samp>
            </div>
        </div>
    </div>

    <div class="right-apps">
        <div class="card app card-dashboard" 
            onclick="redirect('{% url 'monitoring' %}')"
            onmouseover="show_element('.not-first-monitoring')"
            onmouseout="hide_element('.not-first-monitoring')">
            <div class="card-stamp">
                <div class="card-stamp-icon bg-blue">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chart-infographic" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <circle cx="7" cy="7" r="4" />
                        <path d="M7 3v4h4" />
                        <line x1="9" y1="17" x2="9" y2="21" />
                        <line x1="17" y1="14" x2="17" y2="21" />
                        <line x1="13" y1="13" x2="13" y2="21" />
                        <line x1="21" y1="12" x2="21" y2="21" />
                    </svg>
                </div>
            </div>
            <h2>Monitoring</h2>
            <div class="card-body last-data">
                <samp style="font-size: small;">
                    <table id="table"
                        data-toggle="table">
                        <thead>
                            <tr>
                                <th scope="col" data-field="source">Source</th>
                                <th scope="col" data-field="datetime">Date</th>
                                <th scope="col" data-field="cpu_percent">%CPU</th>
                                <th scope="col" data-field="memory_percent">%RAM</th>
                                <th scope="col" data-field="disk_percent">%Disque</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% if data.last_usage.0|length > 0 %}
                                {% for usage in data.last_usage %}
                                    <tr
                                    {% if usage == data.last_usage.0 %} 
                                        class="first-element"
                                    {% else %} 
                                        class="not-first-monitoring"
                                    {% endif %}>
                                        <td>{{ usage.source }}</td>
                                        <td class="short-cell">{{ usage.datetime }}</td>
                                        <td>{{ usage.cpu_percent }}</td>
                                        <td>{{ usage.memory_percent }}</td>
                                        <td>{{ usage.disk_percent }}</td>
                                    </tr>
                                {% endfor %}
                            {% else %}
                                <tr class="no-records-found">
                                    <td colspan="5">
                                        Aucune donnée enregistrée cette dernière heure
                                    </td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </samp>
            </div>
        </div>

        <div class="card app card-dashboard">
            <div class="ribbon ribbon-top bg-red">
                En production
                <!-- Download SVG icon from http://tabler-icons.io/i/star -->
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-barrier-block" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                    <path d="M4 7m0 1a1 1 0 0 1 1 -1h14a1 1 0 0 1 1 1v7a1 1 0 0 1 -1 1h-14a1 1 0 0 1 -1 -1z"></path>
                    <path d="M7 16v4"></path>
                    <path d="M7.5 16l9 -9"></path>
                    <path d="M13.5 16l6.5 -6.5"></path>
                    <path d="M4 13.5l6.5 -6.5"></path>
                    <path d="M17 16v4"></path>
                    <path d="M5 20h4"></path>
                    <path d="M15 20h4"></path>
                    <path d="M17 7v-2"></path>
                    <path d="M7 7v-2"></path>
                </svg>
            </div>
            <div class="card-stamp">
                <div class="card-stamp-icon">
                    {% comment %} <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-question-mark" width="33" height="33" viewBox="0 0 24 24" stroke-width="1.5" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M8 8a3.5 3 0 0 1 3.5 -3h1a3.5 3 0 0 1 3.5 3a3 3 0 0 1 -2 3a3 4 0 0 0 -2 4" />
                        <line x1="12" y1="19" x2="12" y2="19.01" />
                    </svg> {% endcomment %}
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-barrier-block" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                        <path d="M4 7m0 1a1 1 0 0 1 1 -1h14a1 1 0 0 1 1 1v7a1 1 0 0 1 -1 1h-14a1 1 0 0 1 -1 -1z"></path>
                        <path d="M7 16v4"></path>
                        <path d="M7.5 16l9 -9"></path>
                        <path d="M13.5 16l6.5 -6.5"></path>
                        <path d="M4 13.5l6.5 -6.5"></path>
                        <path d="M17 16v4"></path>
                        <path d="M5 20h4"></path>
                        <path d="M15 20h4"></path>
                        <path d="M17 7v-2"></path>
                        <path d="M7 7v-2"></path>
                    </svg>
                </div>
            </div>
            <h2>App4</h2>
        </div>
    </div>
</div>
{% endblock content %}
